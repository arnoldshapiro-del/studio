
{
  "entities": {
    "UserProfile": {
      "title": "User Profile",
      "description": "Publicly visible information about a user.",
      "type": "object",
      "properties": {
        "displayName": {
          "type": "string",
          "description": "The user's display name."
        },
        "photoURL": {
          "type": "string",
          "format": "uri",
          "description": "URL of the user's profile picture."
        }
      },
      "required": ["displayName"]
    },
    "AllData": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "AllData",
      "type": "object",
      "description": "A single document containing all of the user's tracking data.",
      "properties": {
        "medication": { "$ref": "#/backend/entities/MedicationState" },
        "water": { "$ref": "#/backend/entities/WaterState" },
        "injection": { "$ref": "#/backend/entities/InjectionState" },
        "workout": { "$ref": "#/backend/entities/WorkoutState" },
        "mood": { "$ref": "#/backend/entities/MoodState" },
        "stress": { "$ref": "#/backend/entities/StressState" },
        "meditation": { "$ref": "#/backend/entities/MeditationState" }
      }
    },
    "DatedEntry": {
      "title": "Dated Entry",
      "type": "object",
      "properties": {
        "date": { "type": "string", "format": "date-time" }
      },
      "required": ["date"]
    },
    "MedicationState": {
      "title": "MedicationState",
      "type": "object",
      "properties": {
        "morning": { "type": "object", "properties": { "time": { "type": "string", "format": "time" } } },
        "evening": { "type": "object", "properties": { "time": { "type": "string", "format": "time" } } },
        "history": {
          "type": "array",
          "items": { "$ref": "#/backend/entities/MedicationEntry" }
        }
      }
    },
    "MedicationEntry": {
        "title": "Medication Entry",
        "type": "object",
        "allOf": [{ "$ref": "#/backend/entities/DatedEntry" }],
        "properties": {
            "period": { "type": "string", "enum": ["morning", "evening"] },
            "time": { "type": "string", "format": "time" }
        },
        "required": ["period", "time"]
    },
    "WaterState": {
      "title": "WaterState",
      "type": "object",
      "properties": {
        "history": {
          "type": "array",
          "items": { "$ref": "#/backend/entities/WaterEntry" }
        }
      }
    },
    "WaterEntry": {
        "title": "Water Entry",
        "type": "object",
        "allOf": [{ "$ref": "#/backend/entities/DatedEntry" }],
        "properties": {
            "period": { "type": "string", "enum": ["morning", "afternoon", "evening"] }
        },
        "required": ["period"]
    },
    "InjectionState": {
      "title": "InjectionState",
      "type": "object",
      "properties": {
        "startDate": { "type": "string", "format": "date-time" },
        "frequency": { "type": "number" },
        "history": { "type": "array", "items": { "$ref": "#/backend/entities/InjectionEntry" } }
      }
    },
    "InjectionEntry": {
        "title": "Injection Entry",
        "type": "object",
        "allOf": [{ "$ref": "#/backend/entities/DatedEntry" }],
        "properties": {
            "id": { "type": "string" }
        },
        "required": ["id"]
    },
    "WorkoutState": {
      "title": "WorkoutState",
      "type": "object",
      "properties": {
        "treadmill": {
          "type": "object",
          "properties": { "goal": { "type": "number" } }
        },
        "resistance": {
          "type": "object",
          "properties": { "goal": { "type": "number" } }
        },
        "history": {
          "type": "array",
          "items": { "$ref": "#/backend/entities/WorkoutEntry" }
        }
      }
    },
    "WorkoutEntry": {
        "title": "Workout Entry",
        "type": "object",
        "allOf": [{ "$ref": "#/backend/entities/DatedEntry" }],
        "properties": {
            "id": { "type": "string" },
            "type": { "type": "string", "enum": ["treadmill", "resistance"] },
            "startTime": { "type": "string", "format": "time" },
            "endTime": { "type": "string", "format": "time" }
        },
        "required": ["id", "type", "startTime", "endTime"]
    },
    "MoodState": {
      "title": "MoodState",
      "type": "object",
      "properties": {
        "history": {
          "type": "array",
          "items": { "$ref": "#/backend/entities/MoodEntry" }
        }
      }
    },
    "MoodEntry": {
      "title": "MoodEntry",
      "type": "object",
      "allOf": [{ "$ref": "#/backend/entities/DatedEntry" }],
      "properties": {
        "mood": {
          "type": "string",
          "enum": ["great", "good", "neutral", "bad", "awful"],
          "description": "User's self-reported mood rating."
        },
        "notes": {
          "type": "string",
          "description": "Optional notes from the user about their mood."
        }
      },
      "required": ["mood"]
    },
    "StressState": {
      "title": "StressState",
      "type": "object",
      "properties": {
        "history": {
          "type": "array",
          "items": { "$ref": "#/backend/entities/StressEntry" }
        }
      }
    },
    "StressEntry": {
      "title": "StressEntry",
      "type": "object",
      "allOf": [{ "$ref": "#/backend/entities/DatedEntry" }],
      "properties": {
        "level": {
          "type": "number",
          "description": "User's self-reported stress level (1-10)."
        },
        "notes": {
          "type": "string",
          "description": "Optional notes from the user about their stress."
        }
      },
      "required": ["level"]
    },
    "MeditationState": {
      "title": "MeditationState",
      "type": "object",
      "properties": {
        "history": {
          "type": "array",
          "items": { "$ref": "#/backend/entities/MeditationEntry" }
        }
      }
    },
    "MeditationEntry": {
      "title": "MeditationEntry",
      "type": "object",
      "allOf": [{ "$ref": "#/backend/entities/DatedEntry" }],
      "properties": {
        "duration": {
          "type": "number",
          "description": "Duration of the meditation session in minutes."
        }
      },
      "required": ["duration"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "/users/{userId}": {
        "schema": { "$ref": "#/backend/entities/UserProfile" },
        "description": "Stores public user profile information."
    },
    "/users/{userId}/data/{docId}": {
      "schema": "AllData",
      "description": "Stores all user tracking data in a single document for efficient retrieval."
    },
    "/users/{userId}/friends/{friendId}": {
      "schema": {
        "$ref": "#/backend/entities/UserProfile"
      },
      "description": "A list of a user's friends."
    }
  }
}
